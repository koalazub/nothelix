Metadata-Version: 2.4
Name: tree-sitter-notebook
Version: 0.1.0
Summary: Grammar for parsing Jupyter notebook cells with language injection
Author-email: koalazub <elali@cokoala.me>
License: MIT
Project-URL: Homepage, https://github.com/koalazub/nothelix
Project-URL: Funding, https://github.com/koalazub/nothelix
Keywords: incremental,parsing,tree-sitter,notebook
Classifier: Intended Audience :: Developers
Classifier: Topic :: Software Development :: Compilers
Classifier: Topic :: Text Processing :: Linguistic
Classifier: Typing :: Typed
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Provides-Extra: core
Requires-Dist: tree-sitter~=0.24; extra == "core"
Dynamic: license-file

# Nothelix

Jupyter notebooks in the Helix editor.

Nothelix brings interactive notebook workflows to Helix, letting you execute code cells, view outputs, and render inline images without leaving your terminal. It's built for developers and researchers who prefer modal editing but need the exploratory capabilities of notebooks.

## Why Nothelix?

Jupyter notebooks are powerful for data exploration, but the browser-based interface doesn't suit everyone. If you've ever wanted to edit `.ipynb` files with the speed of Helix's modal editing, or run notebook cells from a proper text editor, Nothelix bridges that gap.

The plugin converts notebooks into a readable cell format, manages kernel connections for code execution, and handles inline image rendering for plot outputs. All the heavy lifting happens in a Rust library, while Steel (Helix's embedded Scheme) handles the editor integration.

## Requirements

- Helix built with Steel plugin support (from the [steel-event-system branch](https://github.com/helix-editor/helix/pull/8675))
- A Julia installation (for kernel execution)
- A terminal with graphics support (Kitty, Ghostty, WezTerm, iTerm2) for inline images

## Installation

### Using devenv (recommended)

If you have devenv set up:

```bash
git clone https://github.com/yourusername/nothelix
cd nothelix
devenv shell
nothelix-install
```

### Manual installation

Build the library:

```bash
cargo build --release -p libnothelix
```

Copy the library to Steel's native directory:

```bash
mkdir -p ~/.steel/native
cp target/release/libnothelix.dylib ~/.steel/native/  # macOS
cp target/release/libnothelix.so ~/.steel/native/     # Linux
```

Copy the plugin to your Helix config:

```bash
mkdir -p ~/.config/helix/plugins
cp plugin/nothelix.scm ~/.config/helix/plugins/
```

Add to your `~/.config/helix/init.scm`:

```scheme
(require "nothelix.scm")
```

## Usage

Open any `.ipynb` file in Helix. The plugin provides these commands:

| Command | Description |
|---------|-------------|
| `:convert-notebook` | Convert the raw JSON to readable cell format |
| `:execute-cell` | Run the code cell under your cursor |
| `:next-cell` | Jump to the next cell |
| `:previous-cell` | Jump to the previous cell |
| `:cell-picker` | Open an interactive cell navigator |
| `:select-cell` | Select the entire current cell |
| `:select-cell-code` | Select just the code portion |
| `:select-output` | Select the output section |
| `:graphics-check` | Show which graphics protocol is active |

### Keybindings

The plugin adds these bindings for `.ipynb` files:

- `]l` — next cell
- `[l` — previous cell
- `gnr` — execute cell
- `<space>nj` — cell picker
- `<space>nc` — select cell
- `<space>ns` — select cell code
- `<space>no` — select output

## Configuration

Create `~/.config/helix/nothelix.toml` to override defaults:

```toml
[graphics]
# Graphics protocol: "auto", "kitty", "iterm2", "sixel", or "none"
protocol = "auto"
```

The auto-detection checks your terminal environment and selects the best available protocol. Override this if detection doesn't work for your setup.

## Graphics Protocol Support

Nothelix renders plot outputs inline using your terminal's graphics protocol:

| Protocol | Terminals | Quality |
|----------|-----------|---------|
| Kitty | Kitty, Ghostty, WezTerm | Excellent |
| iTerm2 | iTerm2 | Good |
| Sixel | xterm, mlterm, foot | Limited |

If no graphics protocol is available, plot outputs display as text placeholders.

## Architecture

The project has two parts:

**libnothelix** is a Rust library that handles performance-critical operations: parsing notebook JSON, detecting image formats, converting between formats (SVG to PNG, etc.), and generating terminal escape sequences for inline images.

**nothelix.scm** is a Steel plugin that integrates with Helix. It manages kernel processes, handles cell navigation, and orchestrates the rendering pipeline. Steel handles the editor-side logic while Rust does the heavy computation.

This split keeps the plugin responsive. Notebook parsing and image conversion happen in compiled Rust code, while the Scheme layer stays focused on editor integration.

## Current Limitations

- Only Julia kernels are supported currently
- The RawContent API for true inline rendering requires additional Helix patches
- Sixel encoding is not yet implemented (falls back to text placeholders)
- Python kernel support is planned but not yet available

## Development

With devenv:

```bash
devenv shell
nothelix-build      # build the library
nothelix-install    # build and install to ~/.steel and ~/.config/helix
nothelix-uninstall  # remove installed files
```

Generate documentation:

```bash
cargo doc --open -p libnothelix
```

## Licence

MIT
